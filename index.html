<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Rock Paper Scissors</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>

    <script>

        function computerPlay() {
            const choices = ['Rock', 'Paper', 'Scissors'];
            let random = Math.floor(Math.random() * 3);

            // naive solution
            /*let rand = Math.random();
            if (rand < 1/3) {
                return 'rock';
            } else if (rand < 2/3) {
                return 'paper';
            } else {
                return 'scissors';
            } */

            // simpler solution
            return choices[random];
        }

        function playRound(playerSelection, computerSelection) {

            playerSelection = playerSelection.toLowerCase();
            playerSelection = playerSelection.charAt(0).toUpperCase() + playerSelection.slice(1);

            if ( (playerSelection == 'Rock' && computerSelection == 'Scissors') ||
                 (playerSelection == 'Paper' && computerSelection == 'Rock') ||
                 (playerSelection == 'Scissors' && computerSelection == 'Paper') ) {

                return `You win! ${playerSelection} beats ${computerSelection}`;

            } else if ( (playerSelection == 'Rock' && computerSelection == 'Paper') ||
                        (playerSelection == 'Paper' && computerSelection == 'Scissors') ||
                        (playerSelection == 'Scissors' && computerSelection == 'Rock') ) {

                return `You lose! ${computerSelection} beats ${playerSelection}`;

            } else if (playerSelection == computerSelection) {
                return 'Draw!';
            } else {
                throw 'Invalid option. Try again.';
            }

        }

        function game() {
            let playerScore = 0;
            let computerScore = 0;
            let message;

            for (let i = 1; i <= 5; i++) {
                let playerSelection = prompt('Rock, Paper or Scissors?');
                let computerSelection = computerPlay();
                let roundResult = playRound(playerSelection, computerSelection);

                // Using string comparison
                /*if (roundResult > 'You win') {
                    playerScore += 1;
                } else if (roundResult > 'You lose') {
                    computerScore += 1;
                } */

                // Using the includes() method
                if (roundResult.includes('win')) {
                    playerScore++;
                } else if (roundResult.includes('lose')) {
                    computerScore++;
                }

                console.log(`Round ${i}: \nComputer chose ${computerSelection} \n${roundResult}`);
            }

            message = (playerScore > computerScore) ? 'You win!' :
                      (playerScore < computerScore) ? 'You lose!' :
                      'Draw!';

            return `End result:
                    \nYour score: ${playerScore} \nComputer score: ${computerScore} \n\n${message}`;
        }

        console.log(game());

    </script>

</body>
</html>